<!doctype html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>BikeTrip PLANNER</title>

</head>
<body>


<form th:action="@{/ui/auth/logout}" method="post" style="float:right">
    <span>Kliknij żeby się wylogować:</span>
    <button type="submit">Wyloguj</button>
    <input th:if="${_csrf != null}" type="hidden"
           th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
</form>

<h1>BikeTrip PLANNER</h1>


<p th:if="${ok}"  th:text="${ok}"  style="color:green;"></p>
<p th:if="${err}" th:text="${err}" style="color:red;"></p>


<form th:action="@{/ui/routes}" method="get" style="margin: 0 0 1rem 0;">
    Miasto:
    <input name="city" th:value="${param.city}">
    Trudność:
    <select name="difficulty">
        <option value=""></option>
        <option th:each="d : ${difficulties}" th:value="${d}" th:text="${d}"
                th:selected="${param.difficulty} == ${d}"></option>
    </select>
    Min km:
    <input type="number" step="0.1" name="minDistance" th:value="${param.minDistance}">
    Max km:
    <input type="number" step="0.1" name="maxDistance" th:value="${param.maxDistance}">
    Maksymalny czas:
    <input type="number" step="1" name="maxDuration" th:value="${param.maxDuration}">
    <button type="submit">Szukaj</button>
    <a th:href="@{/ui/routes}">Wyczyść</a>
</form>


<h2>Utwórz trasę</h2>
<form th:action="@{/ui/routes}" method="post" style="margin: 0 0 1rem 0;">
    Nazwa: <input name="name" required><br>
    Miasto: <input name="city" required><br>
    Trudność:
    <select name="difficulty">
        <option th:each="d : ${difficulties}" th:value="${d}" th:text="${d}"></option>
    </select><br>
    Dystans (km): <input type="number" step="0.1" name="distance" required><br>
    Czas (min): <input type="number" step="1" name="durationMin" required><br>


    <button type="submit">Utwórz</button>
    <input th:if="${_csrf != null}" type="hidden"
           th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
</form>


<h2>Trasy</h2>
<table border="1" cellpadding="4">
    <tr>
        <th>ID</th><th>Nazwa</th><th>Miasto</th><th>Trudność</th>
        <th>Dystans (km)</th><th>Czas (min)</th><th>Akcje</th>
    </tr>
    <tr th:each="r : ${routes}">
        <td th:text="${r.id}">1</td>
        <td th:text="${r.name}">Nazwa</td>
        <td th:text="${r.city}">Miasto</td>
        <td th:text="${r.difficulty}">EASY</td>
        <td th:text="${#numbers.formatDecimal(r.distance, 1, 1)}">0.0</td>
        <td th:text="${#numbers.formatDecimal(r.duration, 1, 1)}">0</td>
        <td>
            <a th:href="@{'/ui/routes/' + ${r.id}}">Szczegóły</a>

            <form th:action="@{'/ui/routes/' + ${r.id} + '/delete'}"
                  method="post" style="display:inline" onsubmit="return confirm('Usunąć trasę?');">
                <button type="submit">Usuń</button>
                <input th:if="${_csrf != null}" type="hidden"
                       th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            </form>
        </td>
    </tr>
</table>
<h2>Wygeneruj trasę</h2>
<form th:action="@{/ui/routes/generate}" method="post" style="margin:0 0 1rem 0;">
    Miasto: <input name="city" placeholder="Gdynia" required>
    Docelowy dystans (km): <input type="number" step="0.5" name="targetKm" min="1" max="50" value="5" required>
    <button type="submit">Wygeneruj</button>
    <input th:if="${_csrf != null}" type="hidden"
           th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
</form>

</body>
</html>

